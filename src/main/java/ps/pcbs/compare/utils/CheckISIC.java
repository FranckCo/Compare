package ps.pcbs.compare.utils;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import ps.pcbs.compare.duke.cleaners.CoCActivityCodeCleaner;
import no.priv.garshol.duke.Cleaner;

public class CheckISIC {

	public static String ISIC_3_CLASSES = "0111 0112 0113 0121 0122 0130 0140 0150 0200 0500 1010 1020 1030 1110 1120 1200 1310 1320 1410 1421 1422 1429 1511 1512 1513 1514 1520 1531 1532 1533 1541 1542 1543 1544 1549 1551 1552 1553 1554 1600 1711 1712 1721 1722 1723 1729 1730 1810 1820 1911 1912 1920 2010 2021 2022 2023 2029 2101 2102 2109 2211 2212 2213 2219 2221 2222 2230 2310 2320 2330 2411 2412 2413 2421 2422 2423 2424 2429 2430 2511 2519 2520 2610 2691 2692 2693 2694 2695 2696 2699 2710 2720 2731 2732 2811 2812 2813 2891 2892 2893 2899 2911 2912 2913 2914 2915 2919 2921 2922 2923 2924 2925 2926 2927 2929 2930 3000 3110 3120 3130 3140 3150 3190 3210 3220 3230 3311 3312 3313 3320 3330 3410 3420 3430 3511 3512 3520 3530 3591 3592 3599 3610 3691 3692 3693 3694 3699 3710 3720 4010 4020 4030 4100 4510 4520 4530 4540 4550 5010 5020 5030 5040 5050 5110 5121 5122 5131 5139 5141 5142 5143 5149 5150 5190 5211 5219 5220 5231 5232 5233 5234 5239 5240 5251 5252 5259 5260 5510 5520 6010 6021 6022 6023 6030 6110 6120 6210 6220 6301 6302 6303 6304 6309 6411 6412 6420 6511 6519 6591 6592 6599 6601 6602 6603 6711 6712 6719 6720 7010 7020 7111 7112 7113 7121 7122 7123 7129 7130 7210 7220 7230 7240 7250 7290 7310 7320 7411 7412 7413 7414 7421 7422 7430 7491 7492 7493 7494 7495 7499 7511 7512 7513 7514 7521 7522 7523 7530 8010 8021 8022 8030 8090 8511 8512 8519 8520 8531 8532 9000 9111 9112 9120 9191 9192 9199 9211 9212 9213 9214 9219 9220 9231 9232 9233 9241 9249 9301 9302 9303 9309 9500 9900";
	public static String ISIC_3_1_CLASSES = "0111 0112 0113 0121 0122 0130 0140 0150 0200 0501 0502 1010 1020 1030 1110 1120 1200 1310 1320 1410 1421 1422 1429 1511 1512 1513 1514 1520 1531 1532 1533 1541 1542 1543 1544 1549 1551 1552 1553 1554 1600 1711 1712 1721 1722 1723 1729 1730 1810 1820 1911 1912 1920 2010 2021 2022 2023 2029 2101 2102 2109 2211 2212 2213 2219 2221 2222 2230 2310 2320 2330 2411 2412 2413 2421 2422 2423 2424 2429 2430 2511 2519 2520 2610 2691 2692 2693 2694 2695 2696 2699 2710 2720 2731 2732 2811 2812 2813 2891 2892 2893 2899 2911 2912 2913 2914 2915 2919 2921 2922 2923 2924 2925 2926 2927 2929 2930 3000 3110 3120 3130 3140 3150 3190 3210 3220 3230 3311 3312 3313 3320 3330 3410 3420 3430 3511 3512 3520 3530 3591 3592 3599 3610 3691 3692 3693 3694 3699 3710 3720 4010 4020 4030 4100 4510 4520 4530 4540 4550 5010 5020 5030 5040 5050 5110 5121 5122 5131 5139 5141 5142 5143 5149 5151 5152 5159 5190 5211 5219 5220 5231 5232 5233 5234 5239 5240 5251 5252 5259 5260 5510 5520 6010 6021 6022 6023 6030 6110 6120 6210 6220 6301 6302 6303 6304 6309 6411 6412 6420 6511 6519 6591 6592 6599 6601 6602 6603 6711 6712 6719 6720 7010 7020 7111 7112 7113 7121 7122 7123 7129 7130 7210 7221 7229 7230 7240 7250 7290 7310 7320 7411 7412 7413 7414 7421 7422 7430 7491 7492 7493 7494 7495 7499 7511 7512 7513 7514 7521 7522 7523 7530 8010 8021 8022 8030 8090 8511 8512 8519 8520 8531 8532 9000 9111 9112 9120 9191 9192 9199 9211 9212 9213 9214 9219 9220 9231 9232 9233 9241 9249 9301 9302 9303 9309 9500 9600 9700 9900";
	public static String ISIC_4_CLASSES = "0111 0112 0113 0114 0115 0116 0119 0121 0122 0123 0124 0125 0126 0127 0128 0129 0130 0141 0142 0143 0144 0145 0146 0149 0150 0161 0162 0163 0164 0170 0210 0220 0230 0240 0311 0312 0321 0322 0510 0520 0610 0620 0710 0721 0729 0810 0891 0892 0893 0899 0910 0990 1010 1020 1030 1040 1050 1061 1062 1071 1072 1073 1074 1075 1079 1080 1101 1102 1103 1104 1200 1311 1312 1313 1391 1392 1393 1394 1399 1410 1420 1430 1511 1512 1520 1610 1621 1622 1623 1629 1701 1702 1709 1811 1812 1820 1910 1920 2011 2012 2013 2021 2022 2023 2029 2030 2100 2211 2219 2220 2310 2391 2392 2393 2394 2395 2396 2399 2410 2420 2431 2432 2511 2512 2513 2520 2591 2592 2593 2599 2610 2620 2630 2640 2651 2652 2660 2670 2680 2710 2720 2731 2732 2733 2740 2750 2790 2811 2812 2813 2814 2815 2816 2817 2818 2819 2821 2822 2823 2824 2825 2826 2829 2910 2920 2930 3011 3012 3020 3030 3040 3091 3092 3099 3100 3211 3212 3220 3230 3240 3250 3290 3311 3312 3313 3314 3315 3319 3320 3510 3520 3530 3600 3700 3811 3812 3821 3822 3830 3900 4100 4210 4220 4290 4311 4312 4321 4322 4329 4330 4390 4510 4520 4530 4540 4610 4620 4630 4641 4649 4651 4652 4653 4659 4661 4662 4663 4669 4690 4711 4719 4721 4722 4723 4730 4741 4742 4751 4752 4753 4759 4761 4762 4763 4764 4771 4772 4773 4774 4781 4782 4789 4791 4799 4911 4912 4921 4922 4923 4930 5011 5012 5021 5022 5110 5120 5210 5221 5222 5223 5224 5229 5310 5320 5510 5520 5590 5610 5621 5629 5630 5811 5812 5813 5819 5820 5911 5912 5913 5914 5920 6010 6020 6110 6120 6130 6190 6201 6202 6209 6311 6312 6391 6399 6411 6419 6420 6430 6491 6492 6499 6511 6512 6520 6530 6611 6612 6619 6621 6622 6629 6630 6810 6820 6910 6920 7010 7020 7110 7120 7210 7220 7310 7320 7410 7420 7490 7500 7710 7721 7722 7729 7730 7740 7810 7820 7830 7911 7912 7990 8010 8020 8030 8110 8121 8129 8130 8211 8219 8220 8230 8291 8292 8299 8411 8412 8413 8421 8422 8423 8430 8510 8521 8522 8530 8541 8542 8549 8550 8610 8620 8690 8710 8720 8730 8790 8810 8890 9000 9101 9102 9103 9200 9311 9312 9319 9321 9329 9411 9412 9420 9491 9492 9499 9511 9512 9521 9522 9523 9524 9529 9601 9602 9603 9609 9700 9810 9820 9900";

	public static enum ISICVersion {V3, V3_1, V4}

	/**
	 * @param args
	 */
	public static void main(String[] args) {

		String TO_CHECK = "11203 1215 1217 1300 1409 14105 15331 15411 15413 15431 15432 15433 15496 15541 15542 16002 17212 17213 17292 18103 18104 18205 19125 19201 2002 20104 20296 21012 21095 22111 22211 22214 22219 22221 22303 24233 24241 24244 24249 25191 25201 25202 25204 26102 26104 26911 26954 26955 26957 26958 26961 26962 26993 27101 27102 27105 27201 27205 27207 28114 28921 28922 28932 28933 28991 28995 29112 29152 29155 29193 29196 29222 29224 29264 29297 29301 30008 31109 31203 31909 34302 36103 36104 36107 36108 36933 36934 36998 36999 3720 401020 452 45201 45205 45301 45302 45303 45406 50101 50103 50106 50201 50203 50204 50205 50209 50301 50402 50501 51101 51211 51212 51226 51228 51229 51397 51398 51431 51433 51502 51503 51900 52111 52112 52191 52201 52202 52203 52204 52205 52209 52311 52312 52313 52321 52322 52325 52326 52327 52331 52332 52334 52335 52341 52342 52343 52345 52346 52391 52392 52393 52394 52395 52396 52397 52402 52602 52609 55101 55201 55203 60212 60221 60222 63041 63042 63091 63092 64203 64204 64209 65191 65192 65991 65992 65993 65994 66031 66033 67191 70101 70102 70202 71111 71302 72201 72202 72502 73103 74121 74131 74142 74211 74219 74309 74933 74941 74949 74951 74959 74991 74993 74994 74996 74999 75121 75123 75136 75239 80904 80905 85122 85126 85192 85194 85205 92121 92131 92133 92311 92411 92494 92496 92497 93012 93021 93022";
		String[] toCheck = TO_CHECK.split(" ");

		System.out.println(check(toCheck, ISICVersion.V4, new CoCActivityCodeCleaner()));
	}

	public static List<String> check(Iterable<String> codes, ISICVersion version, Cleaner cleaner) {

		List<String> absents = new ArrayList<String> ();
		List<String> isic = getISICList(version);
		for (String code : codes) {
			String cleanCode = (cleaner == null) ? code : cleaner.clean(code);
			if (!isic.contains(cleanCode)) absents.add(code + " (" + cleanCode + ")");
		}
		return absents;
	}

	public static List<String> check(String[] codes, ISICVersion version, Cleaner cleaner) {

		return check(Arrays.asList(codes), version, cleaner);
	}


	public static List<String> getISICList(ISICVersion version) {

		if (version == ISICVersion.V3) return Arrays.asList(ISIC_3_CLASSES.split(" "));
		if (version == ISICVersion.V3_1) return Arrays.asList(ISIC_3_1_CLASSES.split(" "));
		return Arrays.asList(ISIC_4_CLASSES.split(" "));
	}

}
